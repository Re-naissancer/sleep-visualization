<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ·±å¤œæ¢ç´¢ | ç†¬å¤œè¡Œä¸ºå¯è§†åŒ–åˆ†æ</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg-dark: #0a0e1a;
            --bg-card: rgba(20, 30, 50, 0.85);
            --accent: #00d4ff;
            --accent-glow: rgba(0, 212, 255, 0.4);
            --secondary: #7c3aed;
            --tertiary: #f59e0b;
            --danger: #ef4444;
            --success: #10b981;
            --pink: #ec4899;
            --text-main: #f0f4f8;
            --text-muted: #8492a6;
            --border: rgba(100, 140, 200, 0.15);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: var(--bg-dark);
            color: var(--text-main);
            font-family: 'Noto Sans SC', sans-serif;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* æ˜Ÿç©ºèƒŒæ™¯ */
        .stars-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }

        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle 3s infinite alternate;
        }

        @keyframes twinkle {
            0% { opacity: 0.3; }
            100% { opacity: 1; }
        }

        /* é¡¶éƒ¨å¯¼èˆª */
        .header {
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(20px);
            background: rgba(10, 14, 26, 0.85);
            border-bottom: 1px solid var(--border);
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon {
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, var(--accent), var(--secondary));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            box-shadow: 0 0 20px var(--accent-glow);
        }

        .logo-text {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.6rem;
            font-weight: 700;
            background: linear-gradient(90deg, var(--accent), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: 2px;
        }

        .nav-tabs {
            display: flex;
            background: rgba(255,255,255,0.05);
            border-radius: 25px;
            padding: 5px;
            gap: 5px;
        }

        .nav-tab {
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            color: var(--text-muted);
            border: none;
            background: transparent;
        }

        .nav-tab:hover {
            color: var(--text-main);
        }

        .nav-tab.active {
            background: linear-gradient(135deg, var(--accent), var(--secondary));
            color: white;
            box-shadow: 0 4px 15px var(--accent-glow);
        }

        /* ä¸»å®¹å™¨ */
        .main-container {
            padding: 25px;
            position: relative;
            z-index: 1;
        }

        .page-section {
            display: none;
        }

        .page-section.active {
            display: block;
        }

        /* é¡µé¢æ ‡é¢˜ */
        .page-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .page-title {
            font-size: 2.2rem;
            font-weight: 700;
            margin-bottom: 10px;
            background: linear-gradient(90deg, var(--accent), var(--secondary), var(--pink));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .page-subtitle {
            color: var(--text-muted);
            font-size: 1rem;
        }

        /* KPI å¡ç‰‡ */
        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .kpi-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 22px;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .kpi-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, var(--accent), var(--secondary));
        }

        .kpi-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 212, 255, 0.15);
        }

        .kpi-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            margin-bottom: 15px;
        }

        .kpi-label {
            color: var(--text-muted);
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 8px;
        }

        .kpi-value {
            font-family: 'Orbitron', sans-serif;
            font-size: 2.2rem;
            font-weight: 700;
            display: flex;
            align-items: baseline;
            gap: 5px;
        }

        .kpi-unit {
            font-size: 0.9rem;
            color: var(--text-muted);
            font-weight: 400;
        }

        /* å›¾è¡¨ç½‘æ ¼ */
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(12, 1fr);
            gap: 20px;
        }

        .chart-panel {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            transition: all 0.3s ease;
            min-height: 380px;
        }

        .chart-panel:hover {
            border-color: rgba(0, 212, 255, 0.3);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border);
        }

        .chart-title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1rem;
            font-weight: 600;
        }

        .chart-controls {
            display: flex;
            gap: 10px;
        }

        .chart-btn, .custom-select {
            padding: 6px 12px;
            border-radius: 8px;
            border: 1px solid var(--border);
            background: rgba(255,255,255,0.05);
            color: var(--text-muted);
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.2s ease;
        }

        .chart-btn:hover, .chart-btn.active {
            border-color: var(--accent);
            color: var(--accent);
            background: rgba(0, 212, 255, 0.1);
        }

        .custom-select {
            min-width: 150px;
        }

        .custom-select option {
            background: var(--bg-dark);
            color: var(--text-main);
        }

        .chart-body {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        /* åˆ—å®½ */
        .col-4 { grid-column: span 4; }
        .col-5 { grid-column: span 5; }
        .col-6 { grid-column: span 6; }
        .col-7 { grid-column: span 7; }
        .col-8 { grid-column: span 8; }
        .col-12 { grid-column: span 12; }

        /* Tooltip */
        .tooltip {
            position: fixed;
            background: rgba(10, 14, 26, 0.95);
            border: 1px solid var(--accent);
            padding: 14px 18px;
            border-radius: 12px;
            pointer-events: none;
            font-size: 0.85rem;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.2s;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            max-width: 280px;
            line-height: 1.6;
        }

        .tooltip-title {
            font-weight: 600;
            color: var(--accent);
            margin-bottom: 8px;
        }

        .tooltip-row {
            display: flex;
            justify-content: space-between;
            gap: 15px;
            padding: 2px 0;
        }

        /* å›¾ä¾‹ */
        .legend {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 15px;
            justify-content: center;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 0.8rem;
            color: var(--text-muted);
        }

        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 3px;
        }

        /* åŠ è½½åŠ¨ç”» */
        .loader {
            position: fixed;
            inset: 0;
            background: var(--bg-dark);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            gap: 20px;
        }

        .loader-spinner {
            width: 60px;
            height: 60px;
            border: 3px solid var(--border);
            border-top-color: var(--accent);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loader-text {
            font-family: 'Orbitron', sans-serif;
            color: var(--accent);
            font-size: 1.2rem;
            letter-spacing: 3px;
        }

        /* D3 å›¾è¡¨æ ·å¼ */
        .axis line, .axis path {
            stroke: var(--border);
        }

        .axis text {
            fill: var(--text-muted);
            font-size: 11px;
        }

        /* ä¿¡æ¯æ¡† */
        .info-box {
            background: rgba(0, 212, 255, 0.1);
            border: 1px solid rgba(0, 212, 255, 0.3);
            border-radius: 12px;
            padding: 15px 20px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .info-box i {
            color: var(--accent);
            font-size: 1.2rem;
        }

        /* å“åº”å¼ */
        @media (max-width: 1200px) {
            .col-4, .col-5, .col-6, .col-7, .col-8 {
                grid-column: span 6;
            }
        }

        @media (max-width: 768px) {
            .col-4, .col-5, .col-6, .col-7, .col-8, .col-12 {
                grid-column: span 12;
            }
            .kpi-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        /* æ»šåŠ¨æ¡ */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #050810;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--accent);
        }
    </style>
</head>
<body>

<div class="loader" id="loader">
    <div class="loader-spinner"></div>
    <div class="loader-text">LOADING DATA...</div>
</div>

<div class="stars-bg" id="stars"></div>

<header class="header">
    <div class="logo">
        <div class="logo-icon">
            <i class="fa-solid fa-moon"></i>
        </div>
        <span class="logo-text">NIGHTWATCH</span>
    </div>
    <div class="nav-tabs">
        <button class="nav-tab active" data-page="overview">
            <i class="fa-solid fa-chart-pie"></i> æ€»è§ˆ
        </button>
        <button class="nav-tab" data-page="behavior">
            <i class="fa-solid fa-clock"></i> ç†¬å¤œè¡Œä¸º
        </button>
        <button class="nav-tab" data-page="health">
            <i class="fa-solid fa-heartbeat"></i> å¥åº·å½±å“
        </button>
        <button class="nav-tab" data-page="global">
            <i class="fa-solid fa-globe"></i> å…¨çƒå¯¹æ¯”
        </button>
    </div>
</header>

<main class="main-container">
    <!-- ========== ç¬¬ä¸€é¡µï¼šæ€»è§ˆ ========== -->
    <section class="page-section active" id="page-overview">
        <div class="page-header">
            <h1 class="page-title">ğŸŒ™ æ·±å¤œæ•°æ®è§‚å¯Ÿç«™</h1>
            <p class="page-subtitle">æ¢ç´¢ç°ä»£äººçš„ç†¬å¤œè¡Œä¸ºæ¨¡å¼ä¸å¥åº·å½±å“</p>
        </div>

        <div class="kpi-grid">
            <div class="kpi-card">
                <div class="kpi-icon" style="background: linear-gradient(135deg, var(--accent), #0891b2);">
                    <i class="fa-solid fa-users" style="color: white;"></i>
                </div>
                <div class="kpi-label">æ ·æœ¬æ€»æ•°</div>
                <div class="kpi-value" id="kpi-total">0</div>
            </div>
            <div class="kpi-card">
                <div class="kpi-icon" style="background: linear-gradient(135deg, var(--secondary), #a855f7);">
                    <i class="fa-solid fa-bed" style="color: white;"></i>
                </div>
                <div class="kpi-label">å¹³å‡ç¡çœ æ—¶é•¿</div>
                <div class="kpi-value" id="kpi-sleep">0<span class="kpi-unit">å°æ—¶</span></div>
            </div>
            <div class="kpi-card">
                <div class="kpi-icon" style="background: linear-gradient(135deg, var(--danger), #f97316);">
                    <i class="fa-solid fa-fire-flame-curved" style="color: white;"></i>
                </div>
                <div class="kpi-label">å¹³å‡å‹åŠ›æŒ‡æ•°</div>
                <div class="kpi-value" id="kpi-stress">0<span class="kpi-unit">/10</span></div>
            </div>
            <div class="kpi-card">
                <div class="kpi-icon" style="background: linear-gradient(135deg, var(--success), #059669);">
                    <i class="fa-solid fa-person-walking" style="color: white;"></i>
                </div>
                <div class="kpi-label">æ—¥å‡æ­¥æ•°</div>
                <div class="kpi-value" id="kpi-steps">0</div>
            </div>
            <div class="kpi-card">
                <div class="kpi-icon" style="background: linear-gradient(135deg, var(--pink), #db2777);">
                    <i class="fa-solid fa-triangle-exclamation" style="color: white;"></i>
                </div>
                <div class="kpi-label">ç¡çœ éšœç¢ç‡</div>
                <div class="kpi-value" id="kpi-disorder">0<span class="kpi-unit">%</span></div>
            </div>
        </div>

        <div class="charts-grid">
            <div class="chart-panel col-8">
                <div class="chart-header">
                    <div class="chart-title">
                        <i class="fa-solid fa-circle-nodes" style="color: var(--accent);"></i>
                        <span>è¿åŠ¨é‡ vs ç¡çœ è´¨é‡åˆ†æ</span>
                    </div>
                    <div class="chart-controls">
                        <select class="custom-select" id="occupationFilter">
                            <option value="all">æ‰€æœ‰èŒä¸š</option>
                        </select>
                    </div>
                </div>
                <div class="chart-body" id="scatter-chart"></div>
                <div class="legend" id="scatter-legend"></div>
            </div>

            <div class="chart-panel col-4">
                <div class="chart-header">
                    <div class="chart-title">
                        <i class="fa-solid fa-bullseye" style="color: var(--secondary);"></i>
                        <span>å¥åº·æŒ‡æ ‡é›·è¾¾</span>
                    </div>
                </div>
                <div class="chart-body" id="radar-chart"></div>
                <p style="text-align:center; color: var(--text-muted); font-size: 0.8rem; margin-top: 10px;">
                    æ‚¬åœå·¦ä¾§æ°”æ³¡æŸ¥çœ‹ä¸ªäººæ•°æ®
                </p>
            </div>

            <div class="chart-panel col-6">
                <div class="chart-header">
                    <div class="chart-title">
                        <i class="fa-solid fa-chart-column" style="color: var(--tertiary);"></i>
                        <span>BMIç±»åˆ«ä¸ç¡çœ éšœç¢åˆ†å¸ƒ</span>
                    </div>
                </div>
                <div class="chart-body" id="stacked-bar-chart"></div>
            </div>

            <div class="chart-panel col-6">
                <div class="chart-header">
                    <div class="chart-title">
                        <i class="fa-solid fa-brain" style="color: var(--pink);"></i>
                        <span>å‹åŠ›ç­‰çº§åˆ†å¸ƒ</span>
                    </div>
                </div>
                <div class="chart-body" id="donut-chart"></div>
            </div>
        </div>
    </section>

    <!-- ========== ç¬¬äºŒé¡µï¼šç†¬å¤œè¡Œä¸ºåˆ†æ ========== -->
    <section class="page-section" id="page-behavior">
        <div class="page-header">
            <h1 class="page-title">â° ç†¬å¤œè¡Œä¸ºæ·±åº¦åˆ†æ</h1>
            <p class="page-subtitle">äº†è§£äººä»¬åœ¨æ·±å¤œéƒ½åœ¨åšä»€ä¹ˆ</p>
        </div>

        <div class="info-box">
            <i class="fa-solid fa-info-circle"></i>
            <p>æ­¤é¡µé¢å±•ç¤ºæ·±å¤œï¼ˆ22:00-03:00ï¼‰æœŸé—´çš„ç”¨æˆ·è¡Œä¸ºæ•°æ®ï¼ŒåŒ…æ‹¬ç¤¾äº¤åª’ä½“ã€æ¸¸æˆã€å·¥ä½œå­¦ä¹ ç­‰æ´»åŠ¨åˆ†å¸ƒã€‚</p>
        </div>

        <div class="charts-grid">
            <div class="chart-panel col-8">
                <div class="chart-header">
                    <div class="chart-title">
                        <i class="fa-solid fa-fire" style="color: var(--danger);"></i>
                        <span>æ·±å¤œæ´»åŠ¨çƒ­åŠ›å›¾</span>
                    </div>
                    <div class="chart-controls">
                        <button class="chart-btn active" data-type="weekday">å·¥ä½œæ—¥</button>
                        <button class="chart-btn" data-type="weekend">å‘¨æœ«</button>
                    </div>
                </div>
                <div class="chart-body" id="heatmap-chart"></div>
            </div>

            <div class="chart-panel col-4">
                <div class="chart-header">
                    <div class="chart-title">
                        <i class="fa-solid fa-clock" style="color: var(--accent);"></i>
                        <span>24å°æ—¶æ´»è·ƒåº¦</span>
                    </div>
                </div>
                <div class="chart-body" id="clock-chart"></div>
            </div>

            <div class="chart-panel col-5">
                <div class="chart-header">
                    <div class="chart-title">
                        <i class="fa-solid fa-chart-pie" style="color: var(--tertiary);"></i>
                        <span>æ·±å¤œæ´»åŠ¨ç±»å‹å æ¯”</span>
                    </div>
                </div>
                <div class="chart-body" id="activity-pie-chart"></div>
            </div>

            <div class="chart-panel col-7">
                <div class="chart-header">
                    <div class="chart-title">
                        <i class="fa-solid fa-chart-line" style="color: var(--success);"></i>
                        <span>æ·±å¤œäººæ•°è¶‹åŠ¿ï¼ˆæŒ‰å°æ—¶ï¼‰</span>
                    </div>
                </div>
                <div class="chart-body" id="hourly-trend-chart"></div>
            </div>
        </div>
    </section>

    <!-- ========== ç¬¬ä¸‰é¡µï¼šå¥åº·å½±å“åˆ†æ ========== -->
    <section class="page-section" id="page-health">
        <div class="page-header">
            <h1 class="page-title">ğŸ’Š å¥åº·å½±å“åˆ†æ</h1>
            <p class="page-subtitle">æ¢ç´¢ç¤¾äº¤åª’ä½“ä½¿ç”¨ä¸ç¡çœ å¥åº·çš„å…³è”</p>
        </div>

        <div class="charts-grid">
            <div class="chart-panel col-7">
                <div class="chart-header">
                    <div class="chart-title">
                        <i class="fa-brands fa-instagram" style="color: var(--pink);"></i>
                        <span>ç¤¾äº¤åª’ä½“å¯¹ç¡çœ çš„å½±å“</span>
                    </div>
                    <div class="chart-controls">
                        <select class="custom-select" id="ageGroupFilter">
                            <option value="all">æ‰€æœ‰å¹´é¾„æ®µ</option>
                            <option value="18-24">18-24å²</option>
                            <option value="25-34">25-34å²</option>
                            <option value="35-44">35-44å²</option>
                            <option value="45+">45å²ä»¥ä¸Š</option>
                        </select>
                    </div>
                </div>
                <div class="chart-body" id="social-impact-chart"></div>
            </div>

            <div class="chart-panel col-5">
                <div class="chart-header">
                    <div class="chart-title">
                        <i class="fa-solid fa-users-between-lines" style="color: var(--secondary);"></i>
                        <span>å„å¹´é¾„æ®µæ·±å¤œä½¿ç”¨ç‡</span>
                    </div>
                </div>
                <div class="chart-body" id="age-usage-chart"></div>
            </div>

            <div class="chart-panel col-6">
                <div class="chart-header">
                    <div class="chart-title">
                        <i class="fa-solid fa-bed" style="color: var(--accent);"></i>
                        <span>ä½¿ç”¨æ—¶é•¿ä¸ç¡çœ è´¨é‡å…³ç³»</span>
                    </div>
                </div>
                <div class="chart-body" id="hours-sleep-chart"></div>
            </div>

            <div class="chart-panel col-6">
                <div class="chart-header">
                    <div class="chart-title">
                        <i class="fa-solid fa-mobile-screen" style="color: var(--danger);"></i>
                        <span>å¹³å°æˆç˜¾æŒ‡æ•°å¯¹æ¯”</span>
                    </div>
                </div>
                <div class="chart-body" id="addiction-chart"></div>
            </div>
        </div>
    </section>

    <!-- ========== ç¬¬å››é¡µï¼šå…¨çƒå¯¹æ¯” ========== -->
    <section class="page-section" id="page-global">
        <div class="page-header">
            <h1 class="page-title">ğŸŒ å…¨çƒç†¬å¤œåœ°å›¾</h1>
            <p class="page-subtitle">å¯¹æ¯”ä¸åŒå›½å®¶å’Œåœ°åŒºçš„ç¡çœ çŠ¶å†µ</p>
        </div>

        <div class="charts-grid">
            <div class="chart-panel col-6">
                <div class="chart-header">
                    <div class="chart-title">
                        <i class="fa-solid fa-ranking-star" style="color: var(--tertiary);"></i>
                        <span>å„å›½å¹³å‡ç¡çœ æ—¶é•¿æ’å</span>
                    </div>
                    <div class="chart-controls">
                        <button class="chart-btn active" id="sortAsc">å‡åº</button>
                        <button class="chart-btn" id="sortDesc">é™åº</button>
                    </div>
                </div>
                <div class="chart-body" id="global-ranking-chart"></div>
            </div>

            <div class="chart-panel col-6">
                <div class="chart-header">
                    <div class="chart-title">
                        <i class="fa-solid fa-earth-americas" style="color: var(--secondary);"></i>
                        <span>å„åœ°åŒºç†¬å¤œç‡å¯¹æ¯”</span>
                    </div>
                </div>
                <div class="chart-body" id="region-chart"></div>
            </div>

            <div class="chart-panel col-12">
                <div class="chart-header">
                    <div class="chart-title">
                        <i class="fa-solid fa-diagram-project" style="color: var(--accent);"></i>
                        <span>ç¡çœ æ—¶é•¿ vs å·¥ä½œæ—¶é•¿ vs äº’è”ç½‘ä½¿ç”¨</span>
                    </div>
                </div>
                <div class="chart-body" id="global-bubble-chart"></div>
                <div class="legend" id="global-legend"></div>
            </div>
        </div>
    </section>
</main>

<div class="tooltip" id="tooltip"></div>

<script src="index.js"></script>
</body>
</html>
